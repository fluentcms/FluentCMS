<Form Model="@Model"
      OnSubmit="OnSubmit">
    <Typography Size="TextSize.H5">
        Change your Password
    </Typography>
    <Typography Color="Color.Secondary">
        Update your password securely by providing your current and new passwords.
    </Typography>
    <Spacer />
    <Input @bind-Value="Model.OldPassword" 
           autofocus="true"
           Id="changePasswordOldInput"
           Label="Old Password"
           Name="oldPassword"
           Placeholder="Enter your old password..."
           Required="true"/>
    <Input @bind-Value="Model.NewPassword" 
           autofocus="true"
           Id="changePasswordNewInput"
           Label="New Password"
           Name="newPassword"
           Placeholder="Enter new password..."
           Required="true" />
    <Button Block="true"
            Color="Color.Primary"
            id="changePasswordSubmitButton"
            Type="ButtonType.Submit">
        Change password
    </Button>
</Form>

@code
{
    [Inject]
    AuthenticationState AuthenticationState { get; set; }
    [Inject]
    AccountClient AccountClient {get; set;}

    [Inject]
    NavigationManager NavigationManager {get; set;}
    UserChangePasswordRequest Model { get; set; } = new();
    private async Task OnSubmit()
    {
        @* var userId = context.User.Identity *@
        @* Model.UserId = AuthenticationState.User.Identity.Id; *@
        
        await AccountClient.ChangePasswordAsync(Model);
        NavigationManager.NavigateTo("/auth/login");
    }
}